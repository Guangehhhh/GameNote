## RTR_2
---
## 高级着色：BRDF及相关技术

# 球面坐标 SphericalCoordinate
  - 由于光线主要是通过方向来表达，通常用球面坐标表达它们比用笛卡尔坐标系更方便。
  - 球面坐标中的向量用三个元素来指定：
    -   r表示向量的长度
    -   θ表示向量和Z轴的夹角
    -   Φ表示向量在x-y平面上的投影和x轴的逆时针夹角
# 立体角 Solid Angle
  - 是一个物体对特定点的三维空间的角度，是平面角在三维空间中的类比
  - 立体角描述了从原点向一个球面区域张成的视野大小，可以看成是弧度的三维扩展
  - 它描述的是站在某一点的观察者测量到的物体大小的尺度
    - 例如，对于一个特定的观察点，一个在该观察点附近的小物体有可能和一个远处的大物体有着相同的立体角
  - 以观测点为球心，构造一个单位球面
    - 任意物体投影到该单位球面上的投影面积，即为该物体相对于该观测点的立体角
    - 立体角是单位球面上的一块面积，这和“平面角是单位圆上的一段弧长”类似
  - 我们知道弧度是度量二维角度的量，等于角度在单位圆上对应的弧长
    - 单位圆的周长是2π，所以整个圆对应的弧度也是2π
  - 立体角则是度量三维角度的量，用符号Ω表示
    - 单位为立体弧度（也叫球面度，Steradian，简写为sr）
    - 等于立体角在单位球上对应的区域的面积
      - （实际上也就是在任意半径的球上的面积除以半径的平方ω=s/r2 ）
      - 单位球的表面积是4π ，所以整个球面的立体角也是4π

# 投影面积 Foreshortened Area
  - 投影面积描述了一个物体表面的微小区域在某个视线方向上的可见面积
---
# 辐射度学基本量
  - 图形学模拟可见光与各种材质的交互，这个过程涉及到能量的传输
  - 辐射度学（Radiometry）是度量电磁辐射能量传输的学科，也是基于物理着色模型的基础。

  - 辐射度学的基本量
  - 能量（Energy），用符号Q表示，单位焦耳（J）
    - 每个光子都具有一定量的能量，和频率相关，频率越高，能量也越高。
  - 功率（Power），单位瓦特（Watts），或者焦耳／秒（J/s）
# 辐射通量/光通量 Radiant Flux
  - 辐射通量（RadiantFlux，又译作光通量，辐射功率）描述的是在单位时间穿过截面的光能
    - 或每单位时间的辐射能量，通常用Φ来表示，单位是W，瓦特。
    - 其中的Q表示辐射能(Radiant energy)，单位是J，焦耳
# 辐射强度/发光强度 Radiant Intensity
  - 对一个点（比如说点光源）来说，辐射强度表示每单位立体角的辐射通量，用符号I表示，单位
  - 辐射强度(Radiantintensity，又译作发光强度)，表示每单位立体角的辐射通量
    - 通常用符号I表示，单位 瓦特每球面度
# 辐射率/光亮度 Radiance
  - 辐射率（Radiance，又译作光亮度，用符号L表示）表示物体表面沿某一方向的明亮程度
    - 它等于每单位投影面积和单位立体角上的辐射通量，单位是W·sr−1·m−2，瓦特每球面度每平方米
    - 在光学中，光源的辐射率，是描述非点光源时光源单位面积强度的物理量，
      - 定义为在指定方向上的单位立体角和垂直此方向的单位面积上的辐射通量
      - 光亮度L也可以理解为发光程度I在表面dA上的积分

  - 一种直观的辐射率的理解方法是：
    - 将辐射率理解为物体表面的微面元所接收的来自于某方向光源的单位面积的光通量
    - 因此截面选用垂直于该方向的截面，其面积按阴影面积技术计算

  - 辐射率的微分形式：
    - 其中：Φ是辐射通量，单位瓦特（W）；Ω是立体角，单位球面度（sr）
  - 另外需要注意的是，辐射率使用物体表面沿目标方向上的投影面积，而不是面积。

# 辐照度/辉度 Irradiance
  - 辐照度（Irradiance，又译作辉度，辐射照度，用符号E表示）指入射表面的辐射通量
    - 即单位时间内到达单位面积的辐射通量，或到达单位面积的辐射通量，
    - 也就是辐射通量对于面积的密度，用符号E表示，单位瓦特每平方米。

  - 辐照度可以写成辐射率（Radiance）在入射光所形成的半球上的积分：
    - 其中，Ω是入射光所形成的半球。L(ω)是沿ω方向的光亮度。

# BRDF的定义式
  - 可以将给一个表面着色的过程，理解为给定入射的光线数量和方向，计算出指定方向的出射光亮度（radiance）
  - 在计算机图形学领域，BRDF Bidirectional Reflectance Distribution Function
    - 译作双向反射分布函数，是一个用来描述表面如何反射光线的方程
    - 顾名思义，BRDF就是一个描述光如何从给定的两个方向（入射光方向l和出射方向v）在表面进行反射的函数

  - BRDF的精确定义是出射辐射率的微分（differential outgoing
  radiance）和入射辐照度的微分（differential incoming irradiance）之比：

    - 要理解这个方程的含义，可以想象一个表面被一个来自围绕着角度**l**的微立体角的入射光照亮，而这个光照效果由表面的辉度dE来决定。

  - 表面会反射此入射光到很多不同的方向，在给定的任意出射方向v，
    - 光亮度dLo与辐照度dE成一个比例 而两者之间的这个取决于l和v的比例，就是BRDF。


  - 图6 BRDF图示

  - 一个最常见的疑问是，BRDF为什么要取这样的定义
    - BRDF为什么被定义为辐射率（radiance）和辐照度（irradiance）之比
      - 而不是radiance和radiance之比，或者irradiance和irradiance之比呢？
      - 那么，关于这个问题，可以这样理解：
        - 因为照射到入射点的不同方向的光，都可能从指定的反射方向出射
          - 所以当考虑入射时，需要对面积进行积分
        - 而辐照度irradiance正好表示单位时间内到达单位面积的辐射通量
        - 所以BRDF函数，选取入射时的辐照度Irradiance，和出射时的辐射率Radiance
        - 可以简单明了地描述出入射光线经过某个表面反射后如何在各个出射方向上分布
        - 而直观来说，BRDF的值给定了入射方向和出射方向能量的相对量。

# BRDF的非微分形式
  -
# BRDF与着色方程
  -
# 对BRDF的可视化表示
# BRDF的性质
# BRDF的模型分类
# 次表面散射 Subsurface Scattering
  - 在真实世界中许多物体都是半透明的，比如皮肤、玉、蜡、大理石、牛奶等。当光入射到透明或半透明材料表面时，一部分被反射，一部分被吸收，还有一部分经历透射。这些半透明的材质受到数个光源的透射，物体本身就会受到材质的厚度影响而显示出不同的透光性，光线在这些透射部分也可以互相混合、干涉。

  次表面散射，Subsurface
  Scattering，简称SSS(又简称3S)，就是光射入半透明材质后在内部发生散射，最后射出物体并进入视野中产生的现象，是指光从表面进入物体经过内部散射，然后又通过物体表面的其他顶点出射的光线传递过程
# 菲涅尔反射 Fresnel Reflectance
  - 菲涅耳方程（Fresnel
  equations）是一组用于描述光在两种不同折射率的介质中传播时的反射和折射的光学方程。方程中所描述的反射被称作“菲涅耳反射”。

  菲涅尔反射（Fresnel Reflectance）或者菲涅尔效果（Fresnel
  Effect），即当光入射到折射率不同的两个材质的分界面时，一部分光会被反射，而我们所看到的光线会根据我们的观察角度以不同强度反射的现象。

  菲涅尔反射能够真实地模拟真实世界中的反射。在真实世界中，除了金属之外，其它物质均有不同程度的菲涅尔反射效果。

  关于菲涅尔反射，一个很好的例子是一池清水。从水池上笔直看下去（也就是与法线成零度角的方向）的话，我们能够一直看到池底。而如果从接近平行于水面的方向看去的话，水池表面的高光反射会变得非常强以至于你看不到池底

  对于粗糙表面来说，在接近平行方向的高光反射也会增强但不够达到100%的强度.为何如此是因为影响菲涅尔效应的关键参数在于每个微平面的法向量和入射光线的角度，而不是宏观平面的法向量和入射光线的角度。因此我们在宏观层面看到的实际上是微平面的菲涅尔效应的一个平均结果。

  根据菲涅尔反射，若你看向一个圆球，那么圆球中心的反射会较弱，而靠近边缘是反射会较强。另外需注意，这种关系也受折射率影响
# 微平面理论 Microfacet Theory
  - 微表面理论假设表面是由不同方向的微小细节表面，也就是微平面（microfacets）组成。每一个微小的平面都会根据它的法线方向在一个方向上反射光线。

  表面法线朝向光源方向和视线方向中间的微表面会反射可见光。然而，不是所有的表面法线和半角法线（half
  normal）相等的微表面都会反射光线，因为其中有些会被遮挡，如下图所示。


  图14 微平面理论图示

  我们用法线分布函数（Normal Distribution
  Function，简写为NDF），D(h)来描述组成表面一点的所有微表面的法线分布概率。则可以这样理解：向NDF输入一个朝向h，NDF会返回朝向是h的微表面数占微表面总数的比例，比如有8%的微表面朝向是h，那么就有8%的微表面可能将光线反射到v方向。


  图15
  由微平面组成的表面。仅红色微平面的表面法线和半矢量h对齐，能参与从入射光线向量l到视线向量v的光线反射

  NDF的定义式：
  <div  align="center">    
  <img src="media/32.jpg" height = "65" alt="name" align=center />
  </div>


  在微观层面上不规则的表面会造成光的漫反射。例如，模糊的反射是由于光线的散射造成的。而反射的光线并不均匀，因此我们得到的高光反射是模糊的。如下图。


# 基于物理的BRDF · 常见模型
# BSSRDF
# BRDF引申
---
##  基于图像的渲染技术总结
# 渲染谱 The Rendering Spectrum
# 固定视角的渲染 Fixed-View Rendering
# 天空盒 Skyboxes
# 光场渲染 Light Field Rendering
# 精灵与层 Sprites and Layers
# 公告板 Billboarding
# 粒子系统 Particle System
# 替代物 Impostors
# 公告板云 Billboard Clouds
# 图像处理 Image Processing
# 颜色校正 Color Correction
# 色调映射 Tone Mapping
# 镜头眩光和泛光 Lens Flare and Bloom
# 景深 Depth of Field
# 运动模糊 Motion Blur
# 体渲染 Volume Rendering
---
# 延迟渲染
  -
---
##  全局光照:光线追踪、路径追踪与GI
  -


# 非真实感渲染(NPR)
# 渲染加速算法
# 渲染管线优化方法
